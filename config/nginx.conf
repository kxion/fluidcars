worker_processes 1;

events {
  worker_connections 1024;
}

http {

  include mime.types;

  default_type application/octet-stream;

  sendfile on;

  keepalive_timeout 0;

  upstream app_server {
    # fail_timeout=0 means we always retry an upstream even if it failed
    # to return a good HTTP response (in case the Unicorn master nukes a
    # single worker for timing out).

    # for UNIX domain socket setups:
    server unix: /tmp/unicorn.fluidcars.sock fail_timeout=0;
  }

  server {
    listen 80;

    server_name www.fluidcars.com;

    location / {
      proxy_pass http://app_server;
    }

    # Rails error pages
    error_page 500 502 503 504 /500.html;
    location = /500.html {
      root /home/fluidcars.com/current/public;
    }
  }
}